makeInternal = function(par.set, control) {  i = list()  i$fitn.scale = if (control$minimize) 1 else -1  i$best = if (control$minimize) min else max  i$ps.r = filterParams(par.set, c("numeric", "numericvector"))  i$ps.z = filterParams(par.set, c("integer", "integervector"))  i$ps.d = filterParams(par.set, c("discrete", "discretevector", "logical"))  i$n.r = sum(getParamLengths(i$ps.r))  i$n.z = sum(getParamLengths(i$ps.z))  i$n.d = sum(getParamLengths(i$ps.d))  i$ids.r = getParamIds(i$ps.r, repeated=TRUE, with.nr=FALSE)  i$ids.z = getParamIds(i$ps.z, repeated=TRUE, with.nr=FALSE)  i$ids.d = getParamIds(i$ps.d, repeated=TRUE, with.nr=FALSE)  i$lower.r = getLower(i$ps.r)  i$lower.z = getLower(i$ps.z)  i$upper.r = getUpper(i$ps.r)  i$upper.z = getUpper(i$ps.z)  i$values = lapply(i$ids.d, function(id) i$ps.d$pars[[id]]$values)  if (i$n.d > 0)    names(i$values) = i$ids.d  i$values.ns = lapply(i$values, names)  i$decode.order = numeric(length(par.set))  j.r = j.z = j.d = 1  for (j in seq_along(par.set$pars)) {    p = par.set$pars[[j]]    if (p$type %in% c("numeric", "numericvector")) {      i$decode.order[j] = j.r      j.r = j.r + 1    } else if (p$type %in% c("integer", "integervector")) {      i$decode.order[j] = length(i$ps.r$pars) + j.z      j.z = j.z + 1    } else if (p$type %in% c("discrete", "discretevector", "logical")) {      i$decode.order[j] = length(i$ps.r$pars) + length(i$ps.z$pars) + j.d      j.d = j.d + 1    }  }  return(i)}